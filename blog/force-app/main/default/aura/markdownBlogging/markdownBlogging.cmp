<aura:component implements = "force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction" access = "global" >

    <!--Call the markdown resource-->
    <ltng:require scripts = "{!$Resource.markedJS}" styles = "{!$Resource.markedCSS}"></ltng:require>
    <!--Create a attribute to use in the text section with markdown format-->            
    <aura:attribute name = "myVal" type = "String" description = "This is the text to be displayed" default="" />
    <!--Record attibute to use in the path component-->
    <aura:attribute name = "record" type = "Object" description = "A record object view to be displayed" />
    <!--Error variable-->
    <aura:attribute name="recordError" type="String" description="An error message bound to force:recordData" />
    <!--Handle to the action-->
    <aura:handler name = "init" value = "{! this }" action = "{! c.init }"/>

    <force:recordData aura:id="recordEditor" layoutType="FULL" recordId="{!v.recordId}" targetError="{!v.recordError}"
        targetRecord="{!v.myVal}" targetFields="{!v.record}" mode="EDIT" />


    <lightning:card title = "Post Content">
      <!--Call the path component-->
      <c:postPath current = "{!v.record.Status__c}"></c:postPath>
      <!--Create a layout to the page-->
        <lightning:layout>
            <lightning:layoutItem size = "6" padding = "around-small">
                <!--Text Area to write something in the left-->
                <lightning:textarea
                      class = "slds-textarea slds-text-font_monospace" default = " " 
                      name = "myTextArea"  placeholder = "Type something interesting"
                      value = "{!v.record.Content__c}" messageWhenValueMissing = "An empty content cannot be saved."
                      aura:id="postform" required="true" onchange="{!c.handleSaveRecord}" >
                    </lightning:textarea>
                    <!--Button to submit status-->
                <aura:if isTrue = "{!v.record.Status__c == 'Draft'}">
                    <lightning:button label = "Submit the post for review" variant = "brand" onclick = "{!c.handleSubmitReview}" />
                    <aura:set attribute = "else">
                        <aura:if isTrue = "{!v.record.Status__c == 'Ready'}">
                            <lightning:button label = "Submit the post for publish" variant = "brand" onclick = "{!c.handleSubmitPublish}" />
                        </aura:if>
                    </aura:set>     
                </aura:if>
            </lightning:layoutItem>
            <!-- right content - editor of post's content -->
            <div class = "slds-col slds-size_6-of-12 slds-m-left_x-small slds-m-top_x-small">
                <div class = "markdown-body">
                    <aura:unescapedHtml value = "{!v.myVal}" />
                </div>
            </div>
            <aura:if isTrue="{!not(empty(v.recordError))}">
                <div class="recordError">
                    {!v.recordError}</div>
            </aura:if>
        </lightning:layout>
        
     </lightning:card>     
</aura:component>